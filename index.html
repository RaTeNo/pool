<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>
        Document
    </title>
    <link href="css/style.css" rel="stylesheet">
    </link>
</head>

<body>
    <div class="container">
        <div class="start step active" data-step="1">
            <img alt="start" class="start__image" src="image/start.jpg">
            <div class="start__title title">
                Пройдите наш опрос и
                <br>
                получите скидку на товар
                </br>
            </div>
            <button class="start__button button" type="submit">
                <span>
                    Начать Опрос
                </span>
            </button>
            </img>
        </div>
        <div class="voting step" data-step="2">
            <div class="voting__title title">
                Сколько у вас кошек?
            </div>
            <form action="">
                <div class="form_radio">
                    <input checked="" id="radio-1" name="radio" type="radio" value="1">
                    <label class="super" for="radio-1">
                        Одна
                    </label>
                    </input>
                </div>
                <div class="form_radio">
                    <input id="radio-2" name="radio" type="radio" value="2">
                    <label class="super" for="radio-2">
                        Две
                    </label>
                    </input>
                </div>
                <div class="form_radio">
                    <input id="radio-3" name="radio" type="radio" value="3">
                    <label class="super" for="radio-3">
                        Три
                    </label>
                    </input>
                </div>
                <div class="form_radio">
                    <input id="radio-4" name="radio" type="radio" value="4">
                    <label class="super" for="radio-4">
                        Четыре
                    </label>
                    </input>
                </div>
                <div class="form_radio">
                    <input id="radio-5" name="radio" type="radio" value="5">
                    <label class="super" for="radio-5">
                        Пять
                    </label>
                    </input>
                </div>
            </form>
            <div class="voting__questions">
                <div class="voting__question">
                    <div class="voting__question-title">
                        Вопрос <span class="from"></span> из <span class="to"></span>
                    </div>
                    <div class="voting__row">
                        <div class="voting__row-left">
                        </div>
                    </div>
                </div>
                <div class="submit">
                    <button class="button back" type="submit">
                       &nbsp;
                    </button>

                    <button class="voting__button button next" type="submit">
                        <span>
                            Далее
                        </span>
                    </button>
                </div>
            </div>
        </div>
        <div class="answer step" data-step="3">
            <div class="answer__title title">
                Почему вы ответили именно так?
            </div>
            <form action="">
                <div class="answer__label">
                    Минимум 500 символов
                </div>
                <textarea class="answer__textarea required" placeholder="Ваш ответ…"></textarea>
            </form>
            <div class="voting__questions">
                <div class="voting__question">
                    <div class="voting__question-title">
                        Вопрос <span class="from"></span> из <span class="to"></span>
                    </div>
                    <div class="voting__row">
                        <div class="voting__row-left">
                        </div>
                    </div>
                </div>
                <div class="submit">
                    <button class="button back" type="submit">
                       &nbsp;
                    </button>

                    <button class="voting__button button next" type="submit">
                        <span>
                            Далее
                        </span>
                    </button>
                </div>
            </div>
        </div>
        <div class="cat step" data-step="4">
            <div class="cat__title title">
                Какие кошки вам нравятся?
            </div>
            <form action="" class="form2">
                <div class="form_radio">
                    <img alt="cat" class="cat__image" src="image/cat1.jpg">
                    <input checked="" id="radio-6" name="radio" type="radio" value="1">
                    <label class="super cat__label cat__label2" for="radio-6">
                        Домашние
                    </label>
                    </input>
                    </img>
                </div>
                <div class="form_radio">
                    <img alt="cat" class="cat__image" src="image/cat2.jpg">
                    <input id="radio-7" name="radio" type="radio" value="2">
                    <label class="super cat__label cat__label2" for="radio-7">
                        Персидские
                    </label>
                    </input>
                    </img>
                </div>
                <div class="form_radio">
                    <img alt="cat" class="cat__image" src="image/cat3.jpg">
                    <input id="radio-8" name="radio" type="radio" value="3">
                    <label class="super cat__label cat__label2" for="radio-8">
                        Сиамские-
                        <br>
                        две строки
                        </br>
                    </label>
                    </input>
                    </img>
                </div>
                <div class="form_radio">
                    <img alt="cat" class="cat__image" src="image/cat4.jpg">
                    <input id="radio-9" name="radio" type="radio" value="4">
                    <label class="super cat__label cat__label2" for="radio-9">
                        Сибирские
                    </label>
                    </input>
                    </img>
                </div>
            </form>
            <div class="voting__questions">
                <div class="voting__question">
                    <div class="voting__question-title">
                        Вопрос <span class="from"></span> из <span class="to"></span>
                    </div>
                    <div class="voting__row">
                        <div class="voting__row-left">
                        </div>
                    </div>
                </div>
                <div class="submit">
                    <button class="button back" type="submit">
                       &nbsp;
                    </button>

                    <button class="voting__button button next" type="submit">
                        <span>
                            Далее
                        </span>
                    </button>
                </div>
            </div>
        </div>

        <div class="answer step" data-step="5">
            <div class="answer__title title">
                Введите данные
            </div>
            <form action="">
                <div class="input_for_input ">Ваше Имя</div>
                <input class="input_form required" type="text" placeholder="Петров Иван Васильевич">
                <div class="input_for_input">Телефон</div>
                <input class="input_form required imaskjs__input_tel" type="text" placeholder="+7(123)123-12-13">
            </form>
            <div class="voting__questions">
                <div class="voting__question">
                    <div class="voting__question-title">
                        Вопрос <span class="from"></span> из <span class="to"></span>
                    </div>
                    <div class="voting__row">
                        <div class="voting__row-left">
                        </div>
                    </div>
                </div>
                <div class="submit">
                    <button class="button back" type="submit">
                       &nbsp;
                    </button>

                    <button class="voting__button button next" type="submit">
                        <span>
                            Далее
                        </span>
                    </button>
                </div>
            </div>
        </div>

        <div class="answer step" data-step="6">
            <div class="answer__title title">
                Введите данные
            </div>
            <form action="">
                <div class="input_for_input">Ваше Имя</div>
                <input class="input_form required" type="text" placeholder="Петров Иван Васильевич">
            </form>
            <div class="voting__questions">
                <div class="voting__question">
                    <div class="voting__question-title">
                        Вопрос <span class="from"></span> из <span class="to"></span>
                    </div>
                    <div class="voting__row">
                        <div class="voting__row-left">
                        </div>
                    </div>
                </div>
                <div class="submit">
                    <button class="button back" type="submit">
                       &nbsp;
                    </button>

                    <button class="voting__button button next" type="submit">
                        <span>
                            Далее
                        </span>
                    </button>
                </div>
            </div>
        </div>
        <div class="voting step" data-step="7">
            <div class="voting__title title">
                Сколько у вас кошек? (множественный выбор)
            </div>
            <form action="">
                <div class="form_radio">
                    <input checked="" id="checkbox-1" name="radio" type="checkbox" value="1">
                    <label class="super" for="checkbox-1">
                        Одна
                    </label>
                    </input>
                </div>
                <div class="form_radio">
                    <input id="checkbox-2" name="radio" type="checkbox" value="2">
                    <label class="super" for="checkbox-2">
                        Две
                    </label>
                    </input>
                </div>
                <div class="form_radio">
                    <input id="checkbox-3" name="radio" type="checkbox" value="3">
                    <label class="super" for="checkbox-3">
                        Три
                    </label>
                    </input>
                </div>
                <div class="form_radio">
                    <input id="checkbox-4" name="radio" type="checkbox" value="4">
                    <label class="super" for="checkbox-4">
                        Четыре
                    </label>
                    </input>
                </div>
                <div class="form_radio">
                    <input id="checkbox-5" name="radio" type="checkbox" value="5">
                    <label class="super" for="checkbox-5">
                        Пять
                    </label>
                    </input>
                </div>
            </form>
            <div class="voting__questions">
                <div class="voting__question">
                    <div class="voting__question-title">
                        Вопрос <span class="from"></span> из <span class="to"></span>
                    </div>
                    <div class="voting__row">
                        <div class="voting__row-left">
                        </div>
                    </div>
                </div>
                <div class="submit">
                    <button class="button back" type="submit">
                       &nbsp;
                    </button>

                    <button class="voting__button button next" type="submit">
                        <span>
                            Далее
                        </span>
                    </button>
                </div>
            </div>
        </div>


        <div class="finish step" data-step="8">
            <img alt="start" class="finish__image" src="image/finisch.jpg">
            <div class="finish__text">
                Спасибо! Опрос окончен.
            </div>
            <div class="finish__text">
                Ваш №
                <span class="finish-text2">
                    12314234123
                </span>
            </div>
            </img>
        </div>
    </div>
    <script crossorigin="anonymous" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://unpkg.com/imask"></script>
    <script>
    let step = 0;
    let count_quest = 0;
    $(() => {

        var elements = document.getElementsByClassName('imaskjs__input_tel');
        for (var i = 0; i < elements.length; i++) {
          new IMask(elements[i], {
            mask: '+{7}(000)000-00-00',
          });
        }

        count_quest = $(".step").length - 2;
        $(".to").text(count_quest);        
        $(".start__button").on("click", function(e) {
            e.preventDefault();
            next();            
        })

        $(".next").on("click", function(e) {
            e.preventDefault();
            if(validation($(this)))
            {
                next();  
            }
                   
        })

        $(".back").on("click", function(e) {
            e.preventDefault();
            prev();
        })
    });

    function next()
    {
        step++;  
        $(".from").text(step);
        $(".voting__row-left").css("width", step/count_quest*100+"%");
        $(".step.active").removeClass("active").next().addClass("active");

       
    }

    function prev()
    {
        step--;
        $(".from").text(step);       
        $(".step.active").removeClass("active").prev().addClass("active");   
        $(".voting__row-left").css("width", step/count_quest*100+"%");
    }

    function validation(el)
    {   
        $(".step textarea, .step input").removeClass("error");
        let valide = true;
        let textareas = el.parent().parent().prev().find("textarea.required");
        textareas.each(function( index, element ) {     
            console.log($(element).val().length);
            if($(element).val().length<500)
            {
                console.log(444);
                $(element).addClass("error");
                valide =  false;
            }           
        });
        console.log(123);
        let inputs = el.parent().parent().prev().find("input.required");
        inputs.each(function( index, element ) {          
           if($(element).val().length<3)
            {
                $(element).addClass("error");
                valide =  false;
            }
        });       
        return valide;


    }
    </script>
</body>

</html>